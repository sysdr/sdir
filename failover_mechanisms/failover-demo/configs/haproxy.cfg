global
    maxconn 4096
    log stdout local0

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option httplog

frontend web_frontend
    bind *:8080
    default_backend web_servers

backend web_servers
    balance roundrobin
    option httpchk GET /health
    server app1 app-primary:3001 check inter 2000ms
    server app2 app-secondary:3002 check inter 2000ms

listen stats
    bind *:8404
    stats enable
    stats uri /stats
    stats refresh 5s
